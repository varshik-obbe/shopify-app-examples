FROM node:18-alpine

ARG SHOPIFY_API_KEY
ARG PORT
ARG SHOPIFY_API_SECRET
ARG SCOPES
ARG HOST

ENV HOST=$HOST
ENV SCOPES=$SCOPES
ENV SHOPIFY_API_SECRET=$SHOPIFY_API_SECRET
ENV PORT=$PORT
ENV SHOPIFY_API_KEY=$SHOPIFY_API_KEY
EXPOSE 8085
WORKDIR /app
COPY web .
RUN npm install
RUN cd frontend && npm install && npm run build
CMD ["npm", "run", "serve"]
